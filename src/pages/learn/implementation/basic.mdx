import { withContent } from '../../../components/learn/Page.tsx'

export const meta = {
  title: 'การเขียนโปรแกรมสำหรับการแข่งขันเบื้องต้น'
}

export default withContent({ ...meta })

# ภาษาในการเขียนโปรแกรม

ในขณะนี้ ภาษาที่ใช้ในการแข่งขันเขียนโปรแกรมที่นิยมใช้ได้แก่ C++, Java, Python
เช่น การแข่งขัน Google Code Jam 2017, 79% ใช้ C++, 16% ใช้ Python และ 8% ใช้ Java, ผู้เข้าแข่งขันบางคนใช้ภาษาอื่นๆ นอกจากที่กล่าวมาข้างต้น

หลายๆ คนคิดว่าภาษา C++ เป็นภาษาที่ดีที่สุดในการแข่งขันเขียนโปรแกรมคอมพิวเตอร์และภาษา C++ นั้นโดยทั่วไปจะสามารถใช้แข่งขันได้ ข้อดีของการใช้ C++ เพราะเป็นภาษาที่มีประสิทธิภาพและมี standard library (STL) ที่มี library data structure and algorithm จำนวนมากที่สามารถใช้ได้

ในทางกลับกันในระดับที่สูงขึ้น ควรเข้าใจภาษาอื่นด้วย เช่น Big Integer จำเป็นต้องใช้ภาษา python เพราะว่า ภาษา C++ นั้นไม่สามารถคำนวณ Big Integer ได้

ในบทความนี้จะเขียนตัวอย่างในภาษา C++ และ standard library data structure and algorithms ที่ใช้ในการแข่งขันเขียนโปรแกรม และใช้มาตรฐาน C++11 (-std=c++11) ถ้าคุณยังไม่รู้เกี่ยวกับภาษา C++, บทความนี้เป็นบทความเริ่มต้นที่ดี

C++ code template
โค้ดแม่แบบในภาษา C++ ในการแข่งขันเขียนโปรแกรมเป็นดังนี้

```cpp
#include <bits/stdc++.h>
using namespace std;

int main() {
    // โค้ดที่นี่
}
```

`#include <bits/stdc++.h>` เป็นบรรทัดเริ่มแรกในการเขียนโปรแกรม, คำสั่งนี้จะทำให้สามารถใช้ standard library ได้ทั้งหมดและไม่จำเป็นต้อง include ทีละ library อาทิ iostream, vector, algorithm แต่จะสามารถใช้ได้อัตโนมัติ

คำสั่ง using namespace std หมายถึงว่าเราสามารถใช้ standard library ได้โดยตรงโดยไม่ต้องใส่ namespace ไว้ด้านหน้า อาทิเช่น ถ้าไม่ได้ using namespace std; cout จะไม่สามารถใช้งานได้ โดยต้องเรียกใช้ std::cout แทน

ในการ compile โปรแกรมสามารถเรียกใช้คำสั่งต่อไปนี้

`g++ -std=c++11 -O2 -Wall test.cpp -o test`

ในคำสั่งข้างต้นจะสร้าง binary file ที่สร้างจาก source code test.cpp, ใช้ compiler ที่เป็นมาตรฐาน C++11 (-std=c++11) ใช้การ optimize code (-O2) และ แสดงการแจ้งเตือนในส่วนที่มีข้อผิดพลาด (Warnings all error) (-Wall)

# ข้อมูลนำเข้าและข้อมูลส่งออก

ในการแข่งขันส่วนใหญ่ standard streams จะใช้ในการอ่าน Input (ข้อมูลนำเข้า) และส่งออก Output (ข้อมูลส่งออก) ในภาษา C++, standard streams คือ `cin` สำหรับ input, `cout` สำหรับ output นอกจากนี้ในภาษา C จะใช้ function `scanf` และ `printf` ในการรับส่งข้อมูล

ข้อมูลนำเข้าของโปรแกรมนั้นมีหลาย type ตัวอย่างเช่นตัวเลขและสตริง, ทั้งหมดนั้นสามารถอ่านข้อมูลโดยใช้ `cin` ดังโค้ดต่อไปนี้

```cpp
int a, b;
string x;
cin >> a >> b >> x;
```

คำสั่งนี้สามารถทำงานได้ปกติ โดยที่ข้อมูลนำเข้าต้องมีเว้นวรรคอย่างน้อย 1 วรรค หรือมีการขึ้นบรรทัดใหม่ระหว่าง input แต่ละตัว ตัวอย่างเช่น โค้ดด้านบนสามารถอ่านข้อมูลดังต่อไปนี้ได้

```
123 456 monkey
```

```
123   456
monkey
```

ในการส่งออกข้อมูลสามารถใช้ `cout` โดยใช้คำสั่งต่อไปนี้

```cpp
int a = 123, b = 456;
string x = "monkey";
cout << a << " " << b << " " << x << "\n";
```

input และ output บางครั้งจะเป็นขอขวดทำให้โปรแกรมทำงานได้ช้า ใส่โค้ดต่อไปนี้บรรทัดแรกของโปรแกรมจะทำให้ input และ output มีประสิทธิภาพมากขึ้น

```cpp
ios::sync_with_stdio(0);
cin.tie(0);
```

ในการขึ้นบรรทัดใหม่ `"\n"` ทำงานได้เร็วกว่า `endl` เพราะว่า `endl` จะ flush ทุกครั้งที่เรียกคำสั่ง
ภาษา C มีคำสั่ง `scanf, printf` ที่สามารถใช้ได้ใน C++ ด้วย, คำสั่งเหล่านี้จะเร็วกว่าเล็กน้อยแต่จะใช้งานยากกว่ามาก คำสั่งในการรับค่า integer สองตัวจาก input สามารถเขียนได้ดังนี้

```cpp
int a, b;
scanf("%d %d", &a, &b);
```

คำสั่งในการส่งออก integer สองตัวไปยัง output สามารถเขียนได้ดังนี้

```cpp
int a = 123, b = 456;
printf("%d %d\n", a, b);
```

บางครั้งโปรแกรมต้องการรับข้อมูลทั้งบรรทัด รวมถึงการเว้นวรรค สามารถใช้คำสั่ง `getline`ดังนี้

```cpp
string s;
getline(cin, s);
```

ถ้าเราไม่รู้ว่าขนาดของข้อมูลนำเข้าเป็นเท่าใด สามารถใช้คำสั่งต่อไปนี้ได้

```cpp
while(cin >> x) {
    // code
}
```

ใช้คำสั่ง `while` ในการรับข้อมูลนำเข้า จนไม่มีข้อมูลนำเข้าเหลือจึงหยุดทำงาน

ในการแข่งขันบางครั้ง ต้องรับข้อมูล/ส่งออกข้อมูลจากไฟล์ ทางออกที่ดีคือใช้ standard streams, และเพิ่มคำสั่งเหล่านี้ตอนเริ่มต้นโปรแกรม

```cpp
freopen("input.txt", "r", stdin);
freopen("output.txt", "w", stdout);
```

หลังจากใช้คำสั่งนี้ โปรแกรมจะรับข้อมูลจากไฟล์ `"input.txt"` และ เขียนข้อมูลไปยังไฟล์ `"output.txt"`

# การจัดการตัวแปรประเภทตัวเลข

## จำนวนเต็ม (Integer)

เป็นสิ่งใช้บ่อยสุดในการแข่งขันเขียนโปรแกรม, int สามารถเก็บข้อมูลได้ `32-bit` โดยสามารถเก็บข้อมูลระหว่าง $-2^{31}$ ถึง $2^{31}-1$ หรือประมาณ $-2\cdot10^9$ ถึง $2\cdot10^9$ ถ้า int ไม่เพียงพอในการเก็บข้อมูล สามารถใช้ long long ที่สามารถเก็บข้อมูลได้ `64-bit` โดยสามารถเก็บข้อมูลระหว่าง $-2^{63}$ ถึง $2^{63}-1$ หรือประมาณ $-9\cdot10^{18}$ ถึง $9\cdot10^{18}$

คำสั่งต่อไปนี้คือการใช้ `long long`:

```cpp
long long x = 123456789123456789ll;
```

ที่ต่อท้ายด้วย `ll` หมายถึงประเภทของตัวเลขเป็น `long long`

ส่วนที่พลาดบ่อยในการใช้ `long long` คือการใช้ `int` ในบางส่วนของโค้ด ตัวอย่างเช่นโค้ดด้านล่าง

```cpp
int a = 123456789;
long long b = a * a;
cout << b << "\n"; // -1757895751
```

สำหรับข้อผิดพลาดดังกล่างคือ ตัวเลขพจน์ `a*a` เป็นประเภท `int` และผลลัพธ์จะเป็นประเภท `int` จากที่กล่าวมาตัวแปร `b` จะได้รับผลลัพธ์ที่ผิด ปัญหานี้สามารถแก้ได้โยเปลี่ยนเป็ย `(long long) a * a`

## มอดูโล (Modular Arthmetic)

ค่าชอ `x mod m` คือเศษเหลือจากการหาร x ด้วย m ตัวอย่างเช่น `17 mod 5 = 2` เพราะว่า $17=3\cdot5+2$

ในบางครั้งคำตอบของปัญหานั้นเป็นตัวเลขที่ใหญ่มากแต่สามารถส่งออกข้องมูลใน `"modulo m"`, ตัวอย่างเช่นเศษจากการหารคำตอบด้วย m (ตัวอย่างเช่น modulo $10^9+7$) ไอเดียนี้สามารถใช้หาคำตอบขนาดใหญ่ได้โดยที่ใช้ตัวแปรประเภท `int` หรือ `long long`

สมบัติที่สำคัญคือ การบวก การลบ และการคูณ สามารถดำเนินการต่อไปนี้ได้

`(a + b) mod m = (a mod m + b mod m) mod m`

`(a - b) mod m = (a mod m - b mod m) mod m`

`(a * b) mod m = (a mod m * b mod m) mod m`

ดังนั้น เราสามารถหารเศษทุกๆ การดำเนินการได้ ก่อนที่ตัวเลขจะมีขนาดใหญ่

ตัวอย่างเช่น คำนวณค่าของ `n! modulo m`

```cpp
long long x = 1;
for(int i = 2; i <= n; ++i) {
  x = (x*i) % m;
}
cout << x % m << "\n";
```

โดยทั่วไปเราต้องการให้เศษเหลือมีค่าอยู่ระหว่าง `0...m-1` ถึงแม้ว่าใน C++ และภาษาอื่นๆ เศษเหลือสามารถมีค่าเป็นลบได้ วิธีที่ง่ายที่จะยืนยันว่าไม่มีเศษเหลือที่เป็นลบคือคำนวณเศษเหลือก่อนถ้าเศษเหลือยังเป็นลบ ให้บวกด้วย m

```cpp
x = x % m;
if(x < 0) x += m;
```

## จำนวนทศนิยม (Floating point number)

โดยทั่วไปตัวแปรประเภททศนิยม ในการแข่งขันเขียนโปรแกรมจะใช้ ตัวแปรประเภท `double` ขนาด `64-bit` และใน compiler `g++` จะมี ตัวแปรประเภท`long double` ขนาด `80-bit` ในกาณีทั่วไปตัวแปร `double` ก็เพียงพอแล้ว

สำหรับโจทย์ที่ต้องการให้แสดงผลข้อมูลทศนิยมบางขนาด วิธีที่ง่ายคือใช้คำสั่ง `printf` และบอกขนาดของทศนิยมที่ต้องการแสดงผล ตัวอย่างเช่น คำสั่งต่อไปนี้แสดงผลค่า x โดยที่ทศนิยม 9 ตำแหน่ง

```cpp
printf("%.9f\n", x);
```

ส่วนที่ยากในการใช้ทศนิยม คือตัวเลขไม่สามารถแสดงผลอย่างถูกต้อง จะมีความผิดพลาดในการปัดเศษ ตัวอย่างเช่น การแสดงผลของโค้ดดังต่อไปนี้

```cpp
double x = 0.3 * 0.3 + 0.1;
printf("%.20f\n", x) // 0.99999999999999988898
```

การปัดเศษที่ผิดพลาด ทำให้ x น้อยกว่า 1 อยู่เล็กน้อย ในเมื่อคำตอบที่ถูกต้องคือ 1

เป็นเรื่องที่เสี่ยงมากในการเทียบตัวแปรประเภททศนิยมด้วย `==` เพราะว่าจะเป็นไปได้ว่าข้อมูลไม่เท่ากันเพราะความคลาดเคลื่อน วิธีที่ว่าในการแก้ปัญหานี้คือรับประกันว่า ค่าจะเท่ากันก็ต่อเมื่อ ผลต่างของทั้งสองค่านั้นน้อยกว่า $\epsilon$ เมื่อ $\epsilon$ คือตัวเลขที่มีค่าน้อยมาก
ในที่นี้จะใช้ค่า $\epsilon = 10^{-9}$

```cpp
if (abs(a-b) < 1e-9) {
  // a and b are equal
}
```

Attribution: [Competitive Programmer's Handbook by Antti Laaksonen](https://github.com/pllk/cphb/), licensed under [CC BY-NC-SA 3.0](https://creativecommons.org/licenses/by-nc-sa/3.0/)
